# 第12章 シグナルによるプロセス間の通信

* シグナルの2つの用途
    * プロセス間通信
    * ソフトウェア割り込み

```
プロセス --システムコール-> OSカーネル
プロセス <----シグナル----- OSカーネル
    システムコールと違って種類だけ. 引数は送受できない
```

* （アプリケーションでは）ハンドルできないシグナル
    * SIGKILL：プロセスを強制終了
    * SIGSTOP：プロセスを一時停止して、バックグラウンドジョブにする
* サーバーアプリケーションでハンドルするシグナル
    * **サーバーアプリケーション側で独自のハンドラを書くことが比較的多いシグナル** と
しては、次のようなものがあります。
    * SIGTERM：kill() システムコールやkill コマンドがデフォルトで送信するシグナルで、プロセスを終了させるもの
    * SIGHUP
    * どちらもデフォルトの動作はプロセスの終了です。
* コンソールアプリケーションでハンドルするシグナル
    * SIGINT：ユーザーがCtrl+Cでプログラムを終了（ハンドルできるバージョンのSIGKILL）
    * SIGQUIT：ユーザーがCtrl+\でコアダンプを生成し終了
    * SIGTSTP：ユーザーがCtrl+Z で停止させ、バックグラウンド動作をさせる（ハンドルできるバージョンのSIGSTOP）
    * SIGCONT：バックグラウンド動作から戻させる指令
    * SIGWINCH：ウインドウサイズ変更
    * SIGHUP：バックグラウンド動作になったり、プロセスが終了したりして、擬似ターミナルから切断されるときに呼ばれるシグナル

* 備考：コンソールの特殊文字に応じて送られるシグナル
    * stty -a で確認する
    * intr = ^C
    * quit = ^\
    * susp = ^Z
    * (kill = ^U   # SIGKILLのことではなく文字を消す. => man stty)

* Ctrl+CとSIGINTの違い
    * Ctrl+Cとkill -SIGINTの違いからLinuxプロセスグループを理解する | ギークを目指して
    http://equj65.net/tech/linuxprocessgroup/
        * Ctrl+Cを"端末"に入力すると, フォアグラウンドのプロセスと同じプロセスグループに属する全プロセスにSIGINT
        * kill -SIGINTは、そのプロセスだけ
        * なので,
        * 親プロセスにCtrl+C : 子も終了
        * 親プロセスにkill -SIGINT：子プロセスは生き残る

* 12.3 Go言語におけるシグナルの種類
    * `syscall`パッケージで定義されている
* 12.4 シグナルのハンドラを書く
    * signal型のチャネルを作って、os/signalパッケージのNotify()に渡す
    * あとはチャネルにシグナルが送信されるのを待つ
* 12.4.4 シグナルを他のプロセスに送る
    * os.Process構造体のSignal()メソッド
* 12.5 シグナルの応用例 (Server::Starter)
    * <https://github.com/lestrrat-go/server-starter/blob/0.0.2/starter.go#L415>

